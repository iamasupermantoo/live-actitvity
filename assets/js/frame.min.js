requirejs.config({baseUrl:".",paths:{jquery:"/assets/js/jquery-3.3.1.min",hotkeys:"/wall/themes/meepo/assets/plugs/hotkeys-master/dist/hotkeys.min",bindhotkeys:"/wall/themes/meepo/assets/js/bindhotkeys",metapc:"/assets/js/meta-pc.min",barrager:"/assets/plugs/jquery.barrager.js/dist/js/jquery.barrager.min",countup:"/assets/plugs/countUp.js/dist/countUp.min",countupjq:"/assets/js/countUp-jquery.min",fullscreen:"/assets/plugs/private-face-jquery.fullscreen-24f370e/release/jquery.fullscreen-0.4.1.min",
introjs:"/assets/plugs/intro.js-master/minified/intro.min"},shim:{bindhotkeys:{deps:["hotkeys"]},countup:{exports:"CountUp"},countupjq:{deps:["jquery","countup"]},barrager:{deps:["jquery"]},fullscreen:{deps:["jquery"]}}});
requirejs("jquery metapc countup introjs countupjq barrager hotkeys bindhotkeys fullscreen".split(" "),function(a,A,B,x){function C(a){console.log(a)}a(document).ready(function(){D.init();a(".load-container").fadeOut(500,function(){2>parseInt(void 0==window.localStorage.introstep?0:window.localStorage.introstep)&&(x().setOptions(y).start().onexit(C),window.localStorage.introstep=2)})});var y={nextLabel:"\u4e0b\u4e00\u6761",prevLabel:"\u4e0a\u4e00\u6761",skipLabel:"\u8df3\u8fc7\u63d0\u793a",doneLabel:"\u6211\u770b\u5b8c\u4e86",
exitOnOverlayClick:!1,overlayOpacity:.3,showStepNumbers:!1},v=function(){function b(){r(2).done(function(a){0<a.ret&&(g(),e())}).fail(function(){})}function f(){r(1).done(function(d){0<d.ret&&(a("body").barrager.removeAll(),clearTimeout(n),clearTimeout(m))}).fail(function(){})}function e(){var c;1==danmuconfig.isloop&&(c=h.shift());if(2==danmuconfig.isloop)if(h.length>danmuconfig.historynum)c=h.shift();else if(0<h.length){var b=h.length<danmuconfig.historynum?h.length:danmuconfig.historynum;c=h[d%
b];d=d%b+1}else{m=setTimeout(function(){e()},1E3*danmuconfig.looptime);return}c.speed=15+5*Math.random();c.bottom=k+Math.random()*(4==danmuconfig.positionmode?q:q/3);a("body").barrager(c);m=setTimeout(function(){e()},1E3*danmuconfig.looptime)}function g(){a.ajax({url:"wall/ajax_act_get_danmu.php",data:{shenhetime:c},type:"get",dataType:"json"}).done(function(a){if(0==a.ret)for(var d=0,e=a.data.length;d<e;d++){var b={};b.img=a.data[d].avatar;b.info=1==danmuconfig.showname?a.data[d].content:a.data[d].nick_name+
"\uff1a"+a.data[d].content;b.close=!1;b.color=danmuconfig.textcolor;b.old_ie_color=danmuconfig.textcolor;h.push(b);c=c>a.data[d].shenhetime?c:a.data[d].shenhetime}1==a.ret&&(c=a.lasttime)}).always(function(){n=setTimeout(function(){g()},1E4)})}var c=0,d=0,h=[],n,m,k=0,q=a(window).height();1==danmuconfig.positionmode&&(k=q/3*2);2==danmuconfig.positionmode&&(k=q/3);var r=function(d){return a.ajax({url:"wall/ajax_act_danmu_config.php",data:{danmuswitch:d},type:"get",dataType:"json"})};return{toggle:function(){1==
danmuconfig.danmuswitch?(b(),danmuconfig.danmuswitch=2):(f(),danmuconfig.danmuswitch=1)},init:function(){2==danmuconfig.danmuswitch&&(g(),e())},status:function(){return danmuconfig.danmuswitch}}}(),t=function(){function b(){MUSIC[CURRENTPLUG]?e.bgmusic=""==e.bgmusic?MUSIC[CURRENTPLUG].bgmusicpath+"|"+MUSIC[CURRENTPLUG].bgmusicstatus:e.bgmusic:""==e.bgmusic&&(e.bgmusic="/wall/themes/meepo/assets/music/Radetzky_Marsch.mp3|2");var a=e.bgmusic.split("|");g.find("source").attr("src",a[0]);status=a[1];
2==a[1]?g[0].pause():f(g[0]);setTimeout(b,500)}function f(c){var d=c.currentSrc,b=a(c).find("source").attr("src");-1==d.indexOf(b)&&c.load();1==c.paused&&(setTimeout(function(){f(c)},1E3),c.play())}var e=window.sessionStorage,g=a("#bgmusic");e.bgmusic="";return{init:function(){b()},changeBgMusic:function(a,d){e.bgmusic=a+"|"+d.toString()},status:function(){return window.sessionStorage.bgmusic.split("|")[1]},toggle:function(){var a=e.bgmusic.split("|");e.bgmusic=1==a[1]?a[0]+"|2":a[0]+"|1"}}}(),w=
function(){function b(){BACKGROUNDIMAGE[CURRENTPLUG]?e.bgpath=BACKGROUNDIMAGE[CURRENTPLUG].path:""==g&&(e.bgpath="/wall/themes/meepo/assets/images/defaultbg.jpg");if(g!=e.bgpath){var c=g=e.bgpath;".mp4"==c.substr(-4).toLowerCase()?(a("iframe").removeAttr("style"),a(".bgvideo").find("video").attr("src",c),1==a(".bgvideo").find("video")[0].paused&&f(a(".bgvideo").find("video")[0])):(a("iframe").css({"background-image":"url("+c+")"}),a(".bgvideo").find("video").attr("src",""),a(".bgvideo").find("video")[0].pause())}setTimeout(b,
500)}function f(c){var d=c.currentSrc,b=a(c).attr("src");""!=b&&(-1==d.indexOf(b)&&c.load(),1==c.paused&&(setTimeout(function(){f(c)},1E3),c.play()))}var e=window.sessionStorage,g="";return{init:function(){b()},changeBg:function(a){e.bgpath=a}}}(),u=function(){function b(a){f.find("img").attr("src",a)}storage=window.localStorage;var f=a("#box");storage.showqrcode&&2==storage.showqrcode?(f.hide(),storage.showqrcode=2):storage.showqrcode=1;b(""==customqrcode?"./wall/defaultqrcode.php?from="+CURRENTPLUG:
customqrcode);return{toggle:function(){storage.showqrcode=1==storage.showqrcode?2:1;f.toggle()},resize:function(a){f.resizeQrcodeBox(a)},change:function(a){b(a)},status:function(){return storage.showqrcode}}}(),E=function(){function b(){var b=new B("counter",0,{prefix:"\u53c2\u4e0e\u4eba\u6570\uff1a",suffix:"\u4eba"});b.start();null==countsignperson_timer&&(countsignperson_timer=setInterval(function(){a.ajax({url:"/wall/ajax_act_frame.php?action=countperson",type:"get",dataType:"json"}).done(function(e){0<
e.code?b.update(e.data):a("#counter").text("\u65e0\u6570\u636e")}).fail(function(){a("#counter").text("\u65e0\u6570\u636e")})},1E3))}countsignperson_timer=null;return{init:function(){b()}}}(),D=function(){function b(){a(window).on("resize",function(){f()})}function f(){u.resize(QRCODEPOS);a("iframe").height(window.innerHeight)}return{init:function(){F.init();f();w.init();t.init();G.init();E.init();v.init();window.minibar.init();b()}}}();window.minibar=function(){function b(b){b=a.extend({},b);var d=
!1;e.css({cursor:"default"});e.find(".iconfont").css({color:"grey"});e.off("click");g.css({cursor:"default"});g.find(".iconfont").css({color:"grey"});g.off("click");b.btn_start&&(e.find(".iconfont").removeAttr("style"),e.css({cursor:"pointer"}),e.on("click",b.btn_start),d=!0);b.btn_reset&&(g.find(".iconfont").removeAttr("style"),g.css({cursor:"pointer"}),g.on("click",b.btn_reset),d=!0);d?(f.show(),3>parseInt(window.localStorage.introstep)&&(x().setOptions(y).goToStepNumber(3).start().oncomplete(function(){a("#helperaudio")[0].pause()}),
a("#helperaudio")[0].play(),window.localStorage.introstep=3)):f.hide()}var f=a(".navbar-s"),e=f.find(".btn-start"),g=f.find(".btn-reset");return{init:function(a){b(a)}}}();window.roundbar=function(){function b(b){e.find("li").html("");if(0>=b.length)e.hide();else{for(var c="",d=0,h=b.length;d<h;d++)c+='<section class="z z-s" data="'+b[d].action+'"><div><span title="'+b[d].name+'" class="icon iconfont '+b[d].icon+'" style="opacity:'+(1==b[d].current?"1":"0.5")+';"></span></div> </section>';a(c).appendTo(e.find("li"));
e.find("section").on("click",function(d){d.preventDefault();a("iframe").attr("src",a(this).attr("data"))});e.show()}}function f(){var b=a(".menu-item.active"),c=b.width();b=b.offset().left;var d=e.find("li").outerWidth();e.find("li").css({left:b-d/2+c/2+"px"})}var e=a(".subnav");return{init:function(a){b(a);f();f();f()},clear:function(){e.find("li").html("");e.hide()}}};var G=function(){function b(){1==t.status()?(m.find(".iconfont").removeClass("iconyygb"),m.find(".iconfont").addClass("iconyinle")):
(m.find(".iconfont").removeClass("iconyinle"),m.find(".iconfont").addClass("iconyygb"));clearTimeout(z);z=setTimeout(b,500)}function f(b){CURRENTPLUG=b;BACKGROUNDIMAGE[b]?w.changeBg(BACKGROUNDIMAGE[b].path):w.changeBg("/wall/themes/meepo/assets/images/defaultbg.jpg");MUSIC[b]?t.changeBgMusic(MUSIC[b].bgmusicpath,MUSIC[b].bgmusicstatus):t.changeBgMusic("/wall/themes/meepo/assets/music/Radetzky_Marsch.mp3",2);a("iframe").attr("src",PLUGS[b].url);u.change(""==customqrcode?"./wall/defaultqrcode.php?from="+
b:customqrcode);window.minibar.init({})}function e(){a.each(PLUGS,function(a,b){""!=b.hotkey&&hotkeys(b.hotkey,function(b,d){b.preventDefault();f(a)})});hotkeys("ctrl+o,ctrl+d,ctrl+s",function(a,b){a.preventDefault();switch(b.key){case "ctrl+o":n.trigger("click");break;case "ctrl+d":k.trigger("click");break;case "ctrl+s":m.trigger("click")}})}function g(){d.on("click",function(b){b.preventDefault();b=a(this).attr("data");a(this).siblings().removeClass("active");a(this).addClass("active");window.roundbar().clear();
f(b)});n.on("click",function(){a(this).find(".iconfont").hasClass("iconewmgb")?(a(this).find(".iconfont").removeClass("iconewmgb"),a(this).find(".iconfont").addClass("iconewm")):(a(this).find(".iconfont").removeClass("iconewm"),a(this).find(".iconfont").addClass("iconewmgb"));u.toggle()});k.on("click",function(){a(this).find(".iconfont").hasClass("icondmgb")?(a(this).find(".iconfont").removeClass("icondmgb"),a(this).find(".iconfont").addClass("icondmkq")):(a(this).find(".iconfont").removeClass("icondmkq"),
a(this).find(".iconfont").addClass("icondmgb"));v.toggle()});h.on("click",function(b){a.fullscreen.isFullScreen()?(a(this).find(".iconfont").removeClass("iconsp"),a(this).find(".iconfont").addClass("iconqp"),a.fullscreen.exit()):(a(this).find(".iconfont").removeClass("iconqp"),a(this).find(".iconfont").addClass("iconsp"),a("body").fullscreen());b.preventDefault()});m.on("click",function(b){a(this).find(".iconfont").hasClass("iconyygb")?(a(this).find(".iconfont").removeClass("iconyygb"),a(this).find(".iconfont").addClass("iconyinle")):
(a(this).find(".iconfont").removeClass("iconyinle"),a(this).find(".iconfont").addClass("iconyygb"));t.toggle()});q.on("click",function(){window.open("./myadmin/")});c.on("mouseenter",function(b){clearTimeout(p);0==l&&(c.css({opacity:1}),""!=a(".subnav li").html()&&a(".subnav").show(),l=!0)});r.on("mouseenter",function(b){clearTimeout(p);0==l&&(c.css({opacity:1}),""!=a(".subnav li").html()&&a(".subnav").show(),l=!0)});c.on("mouseleave",function(){0!=l&&(p=setTimeout(function(){c.animate({opacity:0},
"fast","linear",function(){a(".subnav").fadeOut(500);l=!1})},3E3))});r.on("mouseleave",function(){0!=l&&(p=setTimeout(function(){c.animate({opacity:0},"fast","linear",function(){a(".subnav").fadeOut(500);l=!1})},3E3))})}var c=a(".navbar"),d=c.find(".menu-item"),h=c.find(".btn-fullscreen"),n=c.find(".btn-qrcode"),m=c.find(".btn-music"),k=c.find(".btn-danmu"),q=c.find(".btn-admin"),r=a(".subnav"),l=!1,p=null,z=null;return{init:function(){A.init(4096,14,4096);b();for(var h=0,f=d.length;h<f;h++){var m=
a(d[h]).attr("data");a(d[h]).find("span").addClass(icons[m])}1==u.status()?(n.find(".iconfont").removeClass("iconewmgb"),n.find(".iconfont").addClass("iconewm")):(n.find(".iconfont").removeClass("iconewm"),n.find(".iconfont").addClass("iconewmgb"));1==v.status()?(k.find(".iconfont").removeClass("icondmkq"),k.find(".iconfont").addClass("icondmgb")):(k.find(".iconfont").removeClass("icondmgb"),k.find(".iconfont").addClass("icondmkq"));g();e();h=.04*c.width();a(".right-item").css({width:h+"px"})}}}(),
F=function(){function b(){a(".button-login").on("click",function(){var b=a("#password").val();a.ajax({url:"wall/login.do.php",data:{password:b},type:"get",dataType:"json"}).done(function(b){0<b.code?(g.fadeOut(500),e.loginstatus=1):f()})})}function f(){c.addClass("shake_effect");setTimeout(function(){c.removeClass("shake_effect")},2E3)}var e=window.localStorage,g=a(".loginformbg"),c=a(".loginform");return{init:function(){"1"==e.loginstatus?g.fadeOut(500):b()}}}();(function(b,a,e,g){var c=function(d,
e){this.$element=d;this.defaults={w:90,h:90,y:18,x:b(a).width()-118};this.options=b.extend({},this.defaults,e)};c.prototype={resize:function(){var d=this;b(e).mousemove(function(a){if(this.move){var c=e.move_target?e.move_target.posix:{x:0,y:0};(e.call_down||function(){b(this.move_target).css({top:a.pageY-c.y,left:a.pageX-c.x});d.coorpos()}).call(this,a,c)}}).mouseup(function(a){b("iframe").removeClass("disableiframe");this.move&&((e.call_up||function(){}).call(this,a),b.extend(this,{move:!1,move_target:null,
call_down:!1,call_up:!1}),a={w:c.width(),h:c.height(),x:c.position().left,y:c.position().top},d.coorpos(),d.ajax_set_qrcodepos(a))}).mousedown(function(c){b("iframe").addClass("disableiframe");c=c||a.event;for(c=c.target||c.srcElement;c;){if(c.id&&"box"==c.id){d.coorpos();return}c=c.parentNode}b(".coor").css("display","none")});var c=this.$element.mousedown(function(a){b(".coor").css({display:"block"});var d=b(this).offset();this.posix={x:a.pageX-d.left,y:a.pageY-d.top};b.extend(e,{move:!0,move_target:this})}).on("mousedown",
".coor-right-bottom",function(a){d.set_call_down(a,1,1)}).on("mousedown",".coor-bottom",function(a){d.set_call_down(a,0,1)}).on("mousedown",".coor-right",function(a){d.set_call_down(a,1,0)}).css({width:d.options.w,height:d.options.h,top:d.options.y,left:d.options.x})},set_call_down:function(a,c,f){var d=this,h=this.$element,g=h.width(),n=h.height(),l=a.pageX,p=a.pageY;b.extend(e,{move:!0,call_down:function(a){1==c&&1==f?h.css({width:Math.max(80,a.pageX-l+g),height:Math.max(80,a.pageX-l+g)}):h.css({width:c?
Math.max(80,a.pageX-l+g):h.width(),height:f?Math.max(80,a.pageY-p+n):h.height()});d.coorpos()}});return!1},coorpos:function(){var a=b(this.$element).find("span");if(""==a.html())a.remove();else{var c=b(this.$element).width();a.css({"font-size":c/16+"px"});a=b(this.$element).height();c=b(".qrcode").position().top;b(".coor-bottom").css({top:a+c-3+"px"});b(".coor-right").css({top:c+a/2-3+"px"});b(".coor-right-bottom").css({top:c+a-3+"px"})}},ajax_set_qrcodepos:function(a){b.ajax({type:"POST",url:"/wall/ajax_act_set_qrcodepos.php",
data:a,dataType:"json",success:function(a){0<a.code&&(QRCODEPOS=a.data)}})},toggle_qrocde:function(){this.$element.toggle()}};b.fn.resizeQrcodeBox=function(d){function e(a){a.preventDefault()}var f=b(a).width(),g=b(a).height(),k={w:90,h:90,y:18,x:b(a).width()-118};d=b.extend({},k,d);k=b.extend({},d);0>d.x&&(k.x=0);0>d.y&&(k.y=0);d.x+d.w>f&&(k.x=f-d.w-20);d.y+d.h>g&&(k.y=g-d.h-20);d=b(this).find("img");d.on("click",e);d.on("mousedown",e);d.on("mousemove",e);d.on("mouseup",e);b(this).find("span").css({"font-size":k.w/
16+"px"});return(new c(this,k)).resize()};b.fn.toggleQrcode=function(){return(new c(this,options)).toggle_qrocde()}})(jQuery,window,document)});